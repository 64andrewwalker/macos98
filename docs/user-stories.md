# 用户故事集 (User Stories)

> **项目**: macOS 98 Desktop Simulation  
> **版本**: 1.0.0  
> **最后更新**: 2024年12月  
> **验证日期**: 2024年12月 (E2E: 41/41 通过)

本文档包含 macOS 98 项目中所有应用模块的用户故事，遵循标准格式：

```
作为 <角色>，我想要 <功能>，以便 <收益>
```

---

## 目录

1. [Calculator (计算器)](#1-calculator-计算器)
2. [TicTacToe (井字游戏)](#2-tictactoe-井字游戏)
3. [About (关于本机)](#3-about-关于本机)
4. [Background Switcher (壁纸切换器)](#4-background-switcher-壁纸切换器)
5. [TextEditor (文本编辑器)](#5-texteditor-文本编辑器)
6. [Finder (文件管理器)](#6-finder-文件管理器)
7. [System Persistence (系统持久化)](#7-system-persistence-系统持久化) 🔄

---

## 1. Calculator (计算器)

### 核心用户故事

#### US-CALC-001: 基本数字输入
> **作为** 一名用户  
> **我想要** 通过点击数字按钮输入数字  
> **以便** 我可以构建要计算的数值

**验收标准:**
- [x] 点击数字 0-9 会在显示屏上显示相应数字
- [x] 连续点击数字会将它们追加到当前数值后
- [x] 初始显示为 "0"
- [x] 当显示为 "0" 时输入新数字会替换它

---

#### US-CALC-002: 基本加法运算
> **作为** 一名用户  
> **我想要** 将两个数字相加  
> **以便** 我可以得到它们的和

**验收标准:**
- [x] 输入第一个数字，点击 "+"，输入第二个数字，点击 "=" 后显示正确结果
- [x] 示例: 7 + 8 = 15

---

#### US-CALC-003: 基本减法运算
> **作为** 一名用户  
> **我想要** 计算两个数字的差  
> **以便** 我可以进行减法计算

**验收标准:**
- [x] 输入第一个数字，点击 "-"，输入第二个数字，点击 "=" 后显示正确结果
- [x] 示例: 9 - 4 = 5

---

#### US-CALC-004: 基本乘法运算
> **作为** 一名用户  
> **我想要** 将两个数字相乘  
> **以便** 我可以得到它们的乘积

**验收标准:**
- [x] 输入第一个数字，点击 "*"，输入第二个数字，点击 "=" 后显示正确结果
- [x] 示例: 6 × 7 = 42

---

#### US-CALC-005: 基本除法运算
> **作为** 一名用户  
> **我想要** 将一个数字除以另一个数字  
> **以便** 我可以得到商

**验收标准:**
- [x] 输入第一个数字，点击 "/"，输入第二个数字，点击 "=" 后显示正确结果
- [x] 示例: 8 ÷ 2 = 4

---

#### US-CALC-006: 小数输入
> **作为** 一名用户  
> **我想要** 输入小数  
> **以便** 我可以进行精确计算

**验收标准:**
- [x] 点击 "." 按钮会在当前数字后添加小数点
- [x] 每个数字只能有一个小数点
- [x] 示例: 3.5 可以正确输入和计算

---

#### US-CALC-007: 清除功能
> **作为** 一名用户  
> **我想要** 清除当前计算  
> **以便** 我可以重新开始新的计算

**验收标准:**
- [x] 点击 "C" 按钮会将显示重置为 "0"
- [x] 清除后可以开始新的计算

---

#### US-CALC-008: 连续计算
> **作为** 一名用户  
> **我想要** 进行连续的多步计算  
> **以便** 我可以链式运算

**验收标准:**
- [x] 可以在不按 "=" 的情况下连续输入运算符
- [x] 示例: 2 + 3 * 4 = 20 (从左到右计算)

---

#### US-CALC-009: 结果精度控制
> **作为** 一名用户  
> **我想要** 看到合理精度的计算结果  
> **以便** 显示不会溢出

**验收标准:**
- [x] 小数位数限制在 8 位以内
- [x] 结果不会因精度问题而显示异常

---

## 2. TicTacToe (井字游戏)

### 核心用户故事

#### US-TTT-001: 开始新游戏
> **作为** 一名玩家  
> **我想要** 看到一个空的 3x3 棋盘  
> **以便** 我可以开始一局新游戏

**验收标准:**
- [x] 游戏启动时显示空的 3x3 网格
- [x] 显示 "Next player: X" 表示 X 先手

---

#### US-TTT-002: 轮流下棋
> **作为** 两名玩家中的一员  
> **我想要** 与对手轮流下棋  
> **以便** 我们可以公平地进行游戏

**验收标准:**
- [x] X 玩家先手
- [x] 每次点击空格子后，玩家自动切换
- [x] 状态栏显示当前轮到哪位玩家

---

#### US-TTT-003: 落子标记
> **作为** 一名玩家  
> **我想要** 点击格子时放置我的标记  
> **以便** 我可以进行游戏

**验收标准:**
- [x] 点击空格子会放置当前玩家的标记 (X 或 O)
- [x] 点击已占用的格子不会有任何效果
- [x] 标记放置后不可更改

---

#### US-TTT-004: 胜利判定
> **作为** 一名玩家  
> **我想要** 在我连成三子时获胜  
> **以便** 游戏有明确的赢家

**验收标准:**
- [x] 横向三连获胜 (3 种可能)
- [x] 纵向三连获胜 (3 种可能)
- [x] 对角线三连获胜 (2 种可能)
- [x] 显示 "Winner: X" 或 "Winner: O"
- [x] 获胜后无法继续落子

---

#### US-TTT-005: 重新开始游戏
> **作为** 一名玩家  
> **我想要** 重新开始一局新游戏  
> **以便** 在游戏结束或想重玩时可以重置

**验收标准:**
- [x] "New Game" 按钮始终可见
- [x] 点击后清空棋盘并重置为 X 先手

---

## 3. About (关于本机)

### 核心用户故事

#### US-ABOUT-001: 查看系统信息
> **作为** 一名用户  
> **我想要** 查看系统的基本信息  
> **以便** 了解当前系统版本

**验收标准:**
- [x] 显示系统名称 "Macintosh System 7"
- [x] 显示项目描述 "MacOS 90s Simulation"
- [x] 显示技术栈 "Built with React & Vite"

---

#### US-ABOUT-002: 查看版权信息
> **作为** 一名用户  
> **我想要** 查看版权声明  
> **以便** 了解软件归属

**验收标准:**
- [x] 显示版权信息 "© 2025 Antigravity"

---

#### US-ABOUT-003: 查看内存信息
> **作为** 一名用户  
> **我想要** 查看模拟的内存配置  
> **以便** 获得真实的复古体验

**验收标准:**
- [x] 显示 "Built-in Memory: 128 MB"
- [x] 显示 "Total Memory: 128 MB"

---

#### US-ABOUT-004: 显示 Apple 标志
> **作为** 一名用户  
> **我想要** 看到经典的 Apple 标志  
> **以便** 获得怀旧的视觉体验

**验收标准:**
- [x] 对话框左上方显示彩色 Apple 标志
- [x] 标志清晰可见

---

## 4. Background Switcher (壁纸切换器)

### 核心用户故事

#### US-BG-001: 浏览可用壁纸
> **作为** 一名用户  
> **我想要** 浏览所有可用的桌面壁纸  
> **以便** 选择我喜欢的一个

**验收标准:**
- [x] 以网格形式显示所有可用壁纸缩略图
- [x] 每个壁纸显示其名称
- [x] 当前选中的壁纸高亮显示

---

#### US-BG-002: 选择壁纸
> **作为** 一名用户  
> **我想要** 点击壁纸来选择它作为桌面背景  
> **以便** 个性化我的桌面

**验收标准:**
- [x] 点击壁纸缩略图会立即应用到桌面
- [x] 选中的壁纸显示视觉高亮反馈

---

#### US-BG-003: 设置显示模式 - Fill (填充)
> **作为** 一名用户  
> **我想要** 设置壁纸为填充模式  
> **以便** 壁纸拉伸填满整个屏幕

**验收标准:**
- [x] 点击 "Fill" 按钮切换到填充模式
- [x] 壁纸拉伸以覆盖整个桌面区域
- [x] 可能会裁剪部分图像

---

#### US-BG-004: 设置显示模式 - Fit (适应)
> **作为** 一名用户  
> **我想要** 设置壁纸为适应模式  
> **以便** 完整显示壁纸而不变形

**验收标准:**
- [x] 点击 "Fit" 按钮切换到适应模式
- [x] 壁纸保持原始比例
- [x] 可能在边缘显示背景色

---

#### US-BG-005: 设置显示模式 - Tile (平铺)
> **作为** 一名用户  
> **我想要** 设置壁纸为平铺模式  
> **以便** 图案重复填满屏幕

**验收标准:**
- [x] 点击 "Tile" 按钮切换到平铺模式
- [x] 壁纸以原始尺寸重复平铺
- [x] 特别适合小图案壁纸

---

## 5. TextEditor (文本编辑器)

### 核心用户故事

#### US-TE-001: 打开文本文件
> **作为** 一名用户  
> **我想要** 打开并查看文本文件内容  
> **以便** 阅读或编辑文档

**验收标准:**
- [x] 双击文件后在编辑器中显示内容
- [x] 支持 .txt 和 .html 文件
- [x] 保留原有格式

---

#### US-TE-002: 编辑文本内容
> **作为** 一名用户  
> **我想要** 在编辑区域输入和修改文本  
> **以便** 创建或编辑文档

**验收标准:**
- [x] 可以在编辑区域自由输入文本
- [x] 支持基本的光标移动和选择
- [x] 修改后显示 "Modified" 状态

---

#### US-TE-003: 保存文件
> **作为** 一名用户  
> **我想要** 保存我的更改  
> **以便** 内容在刷新后不会丢失

**验收标准:**
- [x] 点击 "Save" 按钮保存当前内容
- [x] 保存后 "Modified" 状态消失
- [x] 内容持久化到 IndexedDB (VFS)
- [x] 重新打开文件后内容恢复

---

#### US-TE-004: 修改状态指示
> **作为** 一名用户  
> **我想要** 知道文件是否有未保存的更改  
> **以便** 避免丢失工作

**验收标准:**
- [x] 有未保存更改时保存按钮显示 "Save *"
- [x] 状态栏显示 "Modified"
- [x] 保存后星号消失

---

#### US-TE-005: 字体选择
> **作为** 一名用户  
> **我想要** 选择不同的字体  
> **以便** 自定义文档外观

**验收标准:**
- [x] 提供字体选择下拉框
- [x] 可选字体: Geneva, Times, Courier, Helvetica
- [x] 选择后立即应用到编辑区域

---

#### US-TE-006: 字号选择
> **作为** 一名用户  
> **我想要** 选择不同的字号  
> **以便** 调整文本大小

**验收标准:**
- [x] 提供字号选择下拉框
- [x] 可选字号: 9, 10, 12, 14, 18, 24
- [x] 选择后立即应用

---

#### US-TE-007: 粗体格式
> **作为** 一名用户  
> **我想要** 将选中的文本设为粗体  
> **以便** 强调重要内容

**验收标准:**
- [x] 点击 "B" 按钮切换粗体
- [x] 选中文本应用粗体样式
- [x] 再次点击取消粗体

---

#### US-TE-008: 斜体格式
> **作为** 一名用户  
> **我想要** 将选中的文本设为斜体  
> **以便** 添加强调效果

**验收标准:**
- [x] 点击 "I" 按钮切换斜体
- [x] 选中文本应用斜体样式

---

#### US-TE-009: 下划线格式
> **作为** 一名用户  
> **我想要** 给选中的文本添加下划线  
> **以便** 突出显示内容

**验收标准:**
- [x] 点击 "U" 按钮切换下划线
- [x] 选中文本显示下划线

---

#### US-TE-010: 文本对齐
> **作为** 一名用户  
> **我想要** 设置文本对齐方式  
> **以便** 控制文档排版

**验收标准:**
- [x] 提供对齐按钮: 左对齐、居中、右对齐、两端对齐
- [x] 点击后应用到当前段落

---

#### US-TE-011: 字符和行数统计
> **作为** 一名用户  
> **我想要** 查看文档统计信息  
> **以便** 了解文档长度

**验收标准:**
- [x] 状态栏显示 "Characters: X"
- [x] 状态栏显示 "Lines: Y"
- [x] 编辑时实时更新

---

#### US-TE-012: 富文本格式持久化
> **作为** 一名用户  
> **我想要** 保存格式化的文本  
> **以便** 重新打开时保留格式

**验收标准:**
- [x] 粗体、斜体、对齐等格式随文件保存
- [x] 重新打开后格式完整恢复
- [x] 富文本保存为 .html 格式

---

#### US-TE-013: 帮助文档
> **作为** 一名新用户  
> **我想要** 查看编辑器帮助  
> **以便** 了解如何使用各项功能

**验收标准:**
- [x] 点击帮助按钮打开帮助对话框
- [x] 显示可用的功能说明
- [x] 点击 "OK" 关闭对话框

---

## 6. Finder (文件管理器)

### 核心用户故事

#### US-FINDER-001: 浏览文件夹
> **作为** 一名用户  
> **我想要** 浏览文件系统中的文件夹  
> **以便** 查找和管理我的文件

**验收标准:**
- [x] 显示当前文件夹中的所有项目
- [x] 文件夹显示文件夹图标
- [x] 文件显示文档图标

---

#### US-FINDER-002: 打开文件夹
> **作为** 一名用户  
> **我想要** 双击打开文件夹  
> **以便** 进入该目录查看内容

**验收标准:**
- [x] 双击文件夹导航到该目录
- [x] 更新路径显示
- [x] 显示新目录的内容

---

#### US-FINDER-003: 打开文件
> **作为** 一名用户  
> **我想要** 双击打开文件  
> **以便** 在相应的应用中查看或编辑

**验收标准:**
- [x] 双击文本文件在 TextEditor 中打开
- [x] 调用 `onOpenFile` 回调

---

#### US-FINDER-004: 图标视图
> **作为** 一名用户  
> **我想要** 以图标方式查看文件  
> **以便** 获得更直观的浏览体验

**验收标准:**
- [x] 点击图标视图按钮 (⊞) 切换到图标视图
- [x] 文件以大图标网格形式显示
- [x] 每个图标下方显示文件名

---

#### US-FINDER-005: 列表视图
> **作为** 一名用户  
> **我想要** 以列表方式查看文件  
> **以便** 查看更多文件详情

**验收标准:**
- [x] 点击列表视图按钮 (☰) 切换到列表视图
- [x] 显示文件名、类型、大小列
- [x] 文件夹显示 "Folder"，文件显示 "Document"
- [x] 文件显示大小 (字节)，文件夹显示 "--"

---

#### US-FINDER-006: 路径导航 (面包屑)
> **作为** 一名用户  
> **我想要** 通过路径导航快速跳转  
> **以便** 快速访问上级目录

**验收标准:**
- [x] 显示从根目录到当前目录的路径
- [x] 点击路径中的任意位置可以跳转
- [x] 根目录显示为 "Macintosh HD"

---

#### US-FINDER-007: 返回上级目录
> **作为** 一名用户  
> **我想要** 快速返回上一级目录  
> **以便** 向上导航文件系统

**验收标准:**
- [x] 工具栏有向上按钮 (⬆)
- [x] 点击后返回父目录
- [x] 在根目录时按钮禁用

---

#### US-FINDER-008: 选择文件/文件夹
> **作为** 一名用户  
> **我想要** 单击选择文件或文件夹  
> **以便** 对其进行操作

**验收标准:**
- [x] 单击项目会高亮选中
- [x] 状态栏显示选中项的名称
- [x] 点击其他位置取消选择

---

#### US-FINDER-009: 文件排序
> **作为** 一名用户  
> **我想要** 文件按一定顺序显示  
> **以便** 更容易找到需要的文件

**验收标准:**
- [x] 文件夹排在文件前面
- [x] 同类型项目按字母顺序排列

---

#### US-FINDER-010: 状态栏信息
> **作为** 一名用户  
> **我想要** 查看当前目录的统计信息  
> **以便** 了解目录内容概况

**验收标准:**
- [x] 状态栏显示项目数量 "X items"
- [x] 选中项目时显示选中项名称

---

#### US-FINDER-011: 空目录提示
> **作为** 一名用户  
> **我想要** 在空目录中看到提示  
> **以便** 知道这是空文件夹而非加载问题

**验收标准:**
- [x] 空目录显示 "This folder is empty"

---

#### US-FINDER-012: 加载状态
> **作为** 一名用户  
> **我想要** 看到目录加载的状态  
> **以便** 知道系统正在工作

**验收标准:**
- [x] 加载目录时显示 "Loading..."
- [x] 加载完成后显示内容

---

---

## 7. System Persistence (系统持久化)

> **状态**: 🔄 待实现 (P1)

### 核心用户故事

#### US-SYS-001: 壁纸选择持久化
> **作为** 一名用户  
> **我想要** 我的壁纸选择在刷新页面后仍然保留  
> **以便** 不需要每次都重新设置桌面背景

**验收标准:**
- [x] 选择壁纸后保存到 localStorage
- [x] 页面刷新后恢复上次选择的壁纸
- [x] 壁纸显示模式 (Fill/Fit/Tile) 也一并保存
- [x] 首次访问时使用默认壁纸

**当前状态:** ✅ 已实现 - TDD session 2024-12

---

#### US-SYS-002: 桌面图标位置持久化
> **作为** 一名用户  
> **我想要** 我移动过的图标位置在刷新后仍然保留  
> **以便** 保持我自定义的桌面布局

**验收标准:**
- [x] 拖动图标到新位置后自动保存
- [x] 页面刷新后图标恢复到保存的位置
- [x] 新创建的文件夹/文件图标位置也要保存

**当前状态:** ✅ 已实现 - TDD session 2024-12

---

#### US-SYS-003: 用户创建的文件夹持久化
> **作为** 一名用户  
> **我想要** 我在桌面上创建的新文件夹在刷新后仍然存在  
> **以便** 保留我创建的目录结构

**验收标准:**
- [x] 通过 File > New Folder 创建的文件夹保存到 VFS
- [ ] 页面刷新后文件夹仍然存在于桌面
- [ ] 文件夹图标位置也要保存

**当前状态:** ⚠️ 部分实现 - VFS 持久化已完成，但桌面图标需要同步

---

#### US-SYS-004: 用户编辑文件持久化
> **作为** 一名用户  
> **我想要** 我编辑并保存的文件在刷新后仍然保留  
> **以便** 我的工作不会丢失

**验收标准:**
- [x] 文本文件内容保存到 IndexedDB (VFS)
- [x] 富文本格式 (粗体、斜体、对齐) 随文件保存
- [x] 页面刷新后重新打开文件显示保存的内容

**当前状态:** ✅ 已实现 - TextEditor 通过 VFS 持久化

---

#### US-SYS-005: 窗口状态持久化 (可选)
> **作为** 一名用户  
> **我想要** 打开的窗口状态在刷新后恢复  
> **以便** 快速恢复工作环境

**验收标准:**
- [ ] 保存打开窗口的列表和位置
- [ ] 页面刷新后恢复之前打开的窗口
- [ ] 窗口内容根据应用类型恢复

**当前状态:** ❌ 未实现 - 可作为 P2 功能

---

#### US-SYS-006: 用户偏好设置持久化
> **作为** 一名用户  
> **我想要** 我的偏好设置在刷新后保留  
> **以便** 系统记住我的使用习惯

**验收标准:**
- [ ] 保存 Finder 默认视图模式 (图标/列表)
- [ ] 保存 TextEditor 默认字体和字号
- [ ] 创建统一的设置存储接口

**当前状态:** ❌ 未实现 - 可作为 P2 功能

---

## 用户故事追溯矩阵

| 应用/模块 | 用户故事数量 | 实现状态 | E2E 测试覆盖 | 验证状态 |
|----------|-------------|----------|--------------|---------|
| Calculator | 9 | ✅ 完成 | 8 | ✅ 已验证 |
| TicTacToe | 5 | ✅ 完成 | 4 | ✅ 已验证 |
| About | 4 | ✅ 完成 | 2 | ✅ 已验证 |
| Background Switcher | 5 | ✅ 完成 | 0 | ✅ 已验证 |
| TextEditor | 13 | ✅ 完成 | 14 | ✅ 已验证 |
| Finder | 12 | ✅ 完成 | 5 | ✅ 已验证 |
| **System Persistence** | **6** | **✅ 4/6** | **17 (unit)** | ✅ 4/6 已验证 |
| **总计** | **54** | **52/54 (96%)** | **41** | **52/54 已验证** |

---

## 优先级说明

| 优先级 | 含义 | 建议 |
|--------|------|------|
| P0 | 必须实现 | 核心功能，阻塞发布 |
| P1 | 应该实现 | 重要功能，影响体验 |
| P2 | 可以实现 | 增强功能，锦上添花 |
| P3 | 未来考虑 | 延后实现 |

当前所有用户故事均已实现 (P0 完成)。

---

## 相关文档

- [`docs/reports/api-review-v2.md`](reports/api-review-v2.md) - API 设计审查
- [`e2e/`](../e2e/) - E2E 测试用例
- [`src/apps/`](../src/apps/) - 应用源代码

